@using System.Diagnostics.Eventing.Reader
@using DrugStockWeb.Utitlities
@model List<DrugStockWeb.ViewModels.StoreReceipt.CreateStoreReceiptDetailViewModel>

<table class="table table-striped table-responsive-sm text-center">
    <thead>
        <tr>
            <th>نام محصول</th>
            <th>شرکت سازنده</th>
            <th>انبار</th>
            <th>بچ نامبر</th>
            <th>تاریخ انقضا</th>
            <th>تعداد</th>
            <th>مانده</th>
            <th>تعداد برگشتی</th>
            <th>قیمت خرید</th>
            <th>قیمت فروش</th>
            <th>جمع قیمت خرید</th>
            <th>جمع قیمت فروش</th>
            <th>عملیات</th>

        </tr>
    </thead>
    <tbody>
        @{
            long sumBuyTotal = 0;
            long sumSellTotal = 0;

            foreach (var item in Model)
            {
                sumBuyTotal += (item.BuyPrice * item.Count);
                sumSellTotal += (item.SellPrice * item.Count);

                <tr>

                    <td>@item.ProductTitle</td>
                    <td>
                        @if (item.ManufactureTitle != null)
                        {
                            @item.ManufactureTitle
                        }
                    </td>
                    <td>@item.StoreTitle</td>
                    <td>@item.BatchNumber</td>
                    <td>@item.ExpireDate.ToShortDateString() ( @item.ExpireDate.ToShamsi(PersianDateTimeFormat.Date) )</td>
                    <td>@item.Count</td>
                    <td>
                        @if (item.RemainingCount != null)
                        {
                            @item.RemainingCount.Value
                        }
                        else
                        {
                            @item.Count
                        }
                    </td>
                    <td style="color: red">@item.ReturnTempCount</td>
                    <td>@item.BuyPrice.ToString().Cur()</td>
                    <td>@item.SellPrice.ToString().Cur()</td>
                    <td>@((item.BuyPrice * item.Count).ToString().Cur())</td>
                    <td>@((item.SellPrice * item.Count).ToString().Cur())</td>
                    <td>
                        <div>
                            @* <a onclick="UpdateStoreReceiptDetail('@(item.Id)')" class="btn btn-success shadow btn-xs sharp mr-1"><i class="fa fa-edit" style="cursor: pointer; color: white"></i></a> *@
                            @if (ViewBag.IsConfirmed == 0)
                            {
                                <a onclick="ReturnStoreReceiptDetail('@(item.Id)')" class="btn btn-google shadow btn-xs sharp" style="width: 85px; color: #ffffff"><i style="color: #fff; cursor: pointer" class="fa fa-recycle"></i> مرجوع</a>
                            }

                        </div>
                    </td>
                </tr>
            }
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>جمع</td>
                <td>@(sumBuyTotal.ToString().Cur())</td>
                <td>@(sumSellTotal.ToString().Cur())</td>
                <td>
                </td>
            </tr>
        }
    </tbody>
</table>
